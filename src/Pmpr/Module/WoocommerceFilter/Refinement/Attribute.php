<?php
/*   _______________________________________
    |  Obfuscated by PMPR - Php Obfuscator  |
    |             6801065fecb67             |
    |_______________________________________|
*/
 namespace Pmpr\Module\WoocommerceFilter\Refinement; use Pmpr\Common\Foundation\Interfaces\Constants; use Pmpr\Common\Foundation\Interfaces\IconInterface; use Pmpr\Module\WoocommerceFilter\Setting; use Pmpr\Module\WoocommerceFilter\WoocommerceFilter; use WP_Query; use WP_Taxonomy; use WP_Term; class Attribute extends Element { const caieqgyycuwysqkc = '_custom_label'; protected ?string $taxonomy = null; public function __construct() { $this->name = Constants::ATTRIBUTE; $this->type = Constants::ugmwekegkosuuwii; parent::__construct(); } public function render(array $ywmkwiwkosakssii = []) { $seyqqsmuaiegkeeq = $this->mqmocoguqcyymgqu(); if ($seyqqsmuaiegkeeq) { $wekcyscwqougqoam = $this->weysguygiseoukqw(Setting::amoaaekaumwisuic, false); $aoskwucuugeuaeus = $this->caokeucsksukesyo()->kckogqkiycqeumoa(); $awewoweukmqomqmi = $this->uwkmaywceaaaigwo()->kckogqkiycqeumoa(); $gkyciwoiiisgywcs = $this->caokeucsksukesyo()->ywqgcuymeiswqyqc(); $mqeowykqcggsieya = $this->caokeucsksukesyo()->yyoeeseewqmmyaee(); foreach ($seyqqsmuaiegkeeq as $kesssewsiegssiya) { if ($kesssewsiegssiya instanceof WP_Taxonomy) { $ywwsukisoiguygwm = $mqeowykqcggsieya->aakmagwggmkoiiyu($kesssewsiegssiya); if ($this->ayseokmqycoqaigc($ywwsukisoiguygwm)) { $muuwyqowekmoqoig = $this->eeikyioeusswwmme($ywwsukisoiguygwm . Constants::mkucwyayaakigquq, null, false); $sikaymiwcesagayc = $this->eeikyioeusswwmme($ywwsukisoiguygwm . self::lowmsmaykkuowskm, null, 'ID'); $umwqusowiqmyseom = $this->eeikyioeusswwmme($ywwsukisoiguygwm . self::uucggqgemiykigga, null, Constants::eeccqomoaqsawouy); $omwmuycmeqcqokom = $this->wqiaaecemqgacuww($ywwsukisoiguygwm); $seauiwyeoycowegg = [Constants::awkcoioakcaougmq => $umwqusowiqmyseom, Constants::qioguuqkouiccqig => $omwmuycmeqcqokom, Constants::gqiasegggowomgie => $sikaymiwcesagayc, Constants::mkucwyayaakigquq => $muuwyqowekmoqoig]; $seauiwyeoycowegg = $this->ocksiywmkyaqseou(WoocommerceFilter::geiygweugseyomyy . 'pre_get_terms_query_args', $seauiwyeoycowegg, $this); $seauiwyeoycowegg = $this->ocksiywmkyaqseou(WoocommerceFilter::geiygweugseyomyy . "pre_get_{$ywwsukisoiguygwm}_terms_query_args", $seauiwyeoycowegg, $this); $uyuaosigqymaqsaa = $aoskwucuugeuaeus->ciugwooasaqcywas($ywwsukisoiguygwm, $seauiwyeoycowegg); if ($uyuaosigqymaqsaa) { $ymqmyyeuycgmigyo = self::omumymwakeoiwouc . $ywwsukisoiguygwm; $eqgoocgaqwqcimie = $this->kokwyquiqyoaaioc()->oiqmuywqkkmuswuc($ymqmyyeuycgmigyo); $omwmuycmeqcqokom = null; if (is_string($eqgoocgaqwqcimie)) { $eqgoocgaqwqcimie = $awewoweukmqomqmi->woimamkkeyoyauoa(Constants::ouywiegeiyuaaawo, $eqgoocgaqwqcimie, $ywwsukisoiguygwm); $omwmuycmeqcqokom = $aoskwucuugeuaeus->owaokmsayecmasqu($eqgoocgaqwqcimie); } foreach ($uyuaosigqymaqsaa as $iwewcwusemqaiggk) { if ($iwewcwusemqaiggk instanceof WP_Term) { if ($omwmuycmeqcqokom instanceof WP_Term && $omwmuycmeqcqokom->term_id === $iwewcwusemqaiggk->term_id) { $gkyciwoiiisgywcs->set($iwewcwusemqaiggk, [Constants::iuqumwggccmcuyem => 0]); } else { $gkyciwoiiisgywcs->set($iwewcwusemqaiggk, [Constants::iuqumwggccmcuyem => 1]); } } } $qookweymeqawmcwo = $this->caokeucsksukesyo()->gyecsegqciqykomu()->ckscqqquyskscaaw($ywmkwiwkosakssii, $this->gayqqwwuycceosii($ymqmyyeuycgmigyo)); if ($wekcyscwqougqoam && $eqgoocgaqwqcimie) { $uyuaosigqymaqsaa = $gkyciwoiiisgywcs->yaeiiwwyckwugsem($uyuaosigqymaqsaa); } $qookweymeqawmcwo[Constants::NAME] = $ymqmyyeuycgmigyo; $qookweymeqawmcwo[Constants::qwumqqyuasyskkkc] = $uyuaosigqymaqsaa; $qookweymeqawmcwo[Constants::qescuiwgsyuikume] = $this->uikgwcuascgeissw($kesssewsiegssiya); $qookweymeqawmcwo[Constants::mkucwyayaakigquq] = $muuwyqowekmoqoig; $qookweymeqawmcwo[Constants::wsckiussqwckiwae] = $this->weysguygiseoukqw(Constants::wsckiussqwckiwae, false); $this->iuygowkemiiwqmiw($this->aakmagwggmkoiiyu(), $qookweymeqawmcwo, [Constants::qaacaqioeyiuakeu => true]); } } } } } } public function gayqqwwuycceosii($ymqmyyeuycgmigyo = null) : array { $qookweymeqawmcwo = parent::gayqqwwuycceosii($ymqmyyeuycgmigyo); $qookweymeqawmcwo['selected'] = $this->yuaqmekuuqoyiwoc($ymqmyyeuycgmigyo); return $qookweymeqawmcwo; } public function yuaqmekuuqoyiwoc($ymqmyyeuycgmigyo) : array { $icwicymcioeyeyek = $this->kokwyquiqyoaaioc()->ioegacqacywgucsc(); $ymmmmaiuoocagigk = []; if ($this->kokwyquiqyoaaioc()->sacmaiqouaeswkyy($icwicymcioeyeyek)) { foreach ($icwicymcioeyeyek as $aaokuekaimigoyue => $uyuaosigqymaqsaa) { if ($aaokuekaimigoyue !== WoocommerceFilter::eigiqicogcmgmgwi && $ymqmyyeuycgmigyo === $aaokuekaimigoyue) { if (is_array($uyuaosigqymaqsaa)) { foreach ($uyuaosigqymaqsaa as $iwewcwusemqaiggk) { $ymmmmaiuoocagigk[] = $this->igaqgiyuucyuyswk($aaokuekaimigoyue, $iwewcwusemqaiggk); } } else { $ymmmmaiuoocagigk[] = $this->igaqgiyuucyuyswk($aaokuekaimigoyue, $uyuaosigqymaqsaa); } } } } return $ymmmmaiuoocagigk; } public function igaqgiyuucyuyswk($ymqmyyeuycgmigyo, $iwewcwusemqaiggk) { $kesssewsiegssiya = $this->guecmwukeoqiwyac($ymqmyyeuycgmigyo); $iwewcwusemqaiggk = $this->uwkmaywceaaaigwo()->kckogqkiycqeumoa()->woimamkkeyoyauoa(Constants::ouywiegeiyuaaawo, $iwewcwusemqaiggk, $kesssewsiegssiya); if ($iwewcwusemqaiggk instanceof WP_Term) { $aoskwucuugeuaeus = $this->caokeucsksukesyo()->kckogqkiycqeumoa(); $iwewcwusemqaiggk = [Constants::kyyscqqmsikeuaea => $kesssewsiegssiya, Constants::ciyoccqkiamemcmm => $aoskwucuugeuaeus->aqcogscycyycgkuq($iwewcwusemqaiggk), Constants::qescuiwgsyuikume => $aoskwucuugeuaeus->qcgakseyaikigqco($iwewcwusemqaiggk), Constants::NAME => $ymqmyyeuycgmigyo]; } return $iwewcwusemqaiggk; } public function ykwqaukkycogooii() { if ($seyqqsmuaiegkeeq = $this->mqmocoguqcyymgqu()) { $uuyucgkyusckoaeq = $this->caokeucsksukesyo()->wmkogisswkckmeua(); $mqeowykqcggsieya = $this->caokeucsksukesyo()->yyoeeseewqmmyaee(); $qgeeqyucwycemwmo = [Constants::imigwosicasiemwu => __('Radio', PR__MDL__WOOCOMMERCE_FILTER), Constants::SELECT => __('Dropdown', PR__MDL__WOOCOMMERCE_FILTER), Constants::ogmccgakwygeuqao => __('Multi Dropdown', PR__MDL__WOOCOMMERCE_FILTER), Constants::ecusimegeasyeese => __('Multi Checkbox', PR__MDL__WOOCOMMERCE_FILTER)]; foreach ($seyqqsmuaiegkeeq as $kesssewsiegssiya) { if ($kesssewsiegssiya instanceof WP_Taxonomy) { $ymqmyyeuycgmigyo = $mqeowykqcggsieya->aakmagwggmkoiiyu($kesssewsiegssiya); $pkyyagewkiyckmwy = $mqeowykqcggsieya->qcgakseyaikigqco($kesssewsiegssiya); $this->ogimmkwaymekmoky($uuyucgkyusckoaeq->mkcwgaeaaweamyyg($ymqmyyeuycgmigyo)->gswweykyogmsyawy($pkyyagewkiyckmwy)->saemoowcasogykak(IconInterface::mloqkcqcaykawyqs)->gucwmccyimoagwcm(sprintf(__('%s Configuration', PR__MDL__WOOCOMMERCE_FILTER), $pkyyagewkiyckmwy))->kwkugmqouisgkqig($uuyucgkyusckoaeq->ycgeeoiieoiakgam($ymqmyyeuycgmigyo . Constants::iusoecsswgekecks)->saemoowcasogykak(IconInterface::wukkqukiiuuoyiiy)->gswweykyogmsyawy(__('General', PR__MDL__WOOCOMMERCE_FILTER))->mkksewyosgeumwsa($uuyucgkyusckoaeq->wcwmusaouiqaqeww($this->esmcwikgmwoaeoyy(Constants::yyicwqsqaecyqwco, $ymqmyyeuycgmigyo))->gswweykyogmsyawy(__('Use in Filter', PR__MDL__WOOCOMMERCE_FILTER))->gucwmccyimoagwcm(__('Check this option, if you want show this item in filter.', PR__MDL__WOOCOMMERCE_FILTER)))->mkksewyosgeumwsa($uuyucgkyusckoaeq->ymuegqgyuagyucws($this->esmcwikgmwoaeoyy(Constants::qescuiwgsyuikume, $ymqmyyeuycgmigyo))->gswweykyogmsyawy(__('Display Title', PR__MDL__WOOCOMMERCE_FILTER))->eyygsasuqmommkua($this->qcgakseyaikigqco())->gucwmccyimoagwcm(__('This title used in filter form as this filter section title..', PR__MDL__WOOCOMMERCE_FILTER)))->mkksewyosgeumwsa($uuyucgkyusckoaeq->gosycecgwuesyysq($this->esmcwikgmwoaeoyy(Constants::qgqyauaqwqmqseim, $ymqmyyeuycgmigyo))->gswweykyogmsyawy(__('Icon', PR__MDL__WOOCOMMERCE_FILTER))))->kwkugmqouisgkqig($uuyucgkyusckoaeq->ycgeeoiieoiakgam($ymqmyyeuycgmigyo . Constants::wiawyoegoyeweaoe)->saemoowcasogykak(IconInterface::isscgcamsuaqwwkc)->gswweykyogmsyawy(__('Advanced', PR__MDL__WOOCOMMERCE_FILTER))->mkksewyosgeumwsa($uuyucgkyusckoaeq->mccagaqeagiikkec($this->esmcwikgmwoaeoyy(self::uimkoimiuiwagwak, $ymqmyyeuycgmigyo))->acauweqyyugwisqc($qgeeqyucwycemwmo)->eyygsasuqmommkua(Constants::imigwosicasiemwu)->gswweykyogmsyawy(__('Filter Type', PR__MDL__WOOCOMMERCE_FILTER))->gucwmccyimoagwcm(sprintf(__('View of the %s terms on the front.', PR__MDL__WOOCOMMERCE_FILTER), $pkyyagewkiyckmwy)))->mkksewyosgeumwsa($uuyucgkyusckoaeq->wcwmusaouiqaqeww($this->esmcwikgmwoaeoyy(Constants::mkucwyayaakigquq, $ymqmyyeuycgmigyo))->gswweykyogmsyawy(__('Hide Unused', PR__MDL__WOOCOMMERCE_FILTER))->gucwmccyimoagwcm(__('Check this item for better performance.', PR__MDL__WOOCOMMERCE_FILTER)))->mkksewyosgeumwsa($uuyucgkyusckoaeq->yyuwuqsiucweeoue($this->esmcwikgmwoaeoyy(self::lowmsmaykkuowskm, $ymqmyyeuycgmigyo))->gswweykyogmsyawy(__('Sort terms', PR__MDL__WOOCOMMERCE_FILTER))->eyygsasuqmommkua('-1')->mkmssscwmeekwgqo()->gucwmccyimoagwcm(__('How to sort terms inside of filter block', PR__MDL__WOOCOMMERCE_FILTER))->acauweqyyugwisqc(['-1' => __('Default', PR__MDL__WOOCOMMERCE_FILTER), Constants::gouqcwikiiygyasc => __('ID', PR__MDL__WOOCOMMERCE_FILTER), Constants::NAME => __('Name', PR__MDL__WOOCOMMERCE_FILTER), 'numeric' => __('Numeric', PR__MDL__WOOCOMMERCE_FILTER)]))->mkksewyosgeumwsa($uuyucgkyusckoaeq->yyuwuqsiucweeoue($this->esmcwikgmwoaeoyy(self::ucqemkuiauocomws, $ymqmyyeuycgmigyo))->gswweykyogmsyawy(__('Sort order', PR__MDL__WOOCOMMERCE_FILTER))->eyygsasuqmommkua(Constants::eeccqomoaqsawouy)->mkmssscwmeekwgqo()->gucwmccyimoagwcm(__('How to sort order inside of filter block', PR__MDL__WOOCOMMERCE_FILTER))->acauweqyyugwisqc([Constants::eeccqomoaqsawouy => __('ASC', PR__MDL__WOOCOMMERCE_FILTER), Constants::omaksceqmigeaoko => __('DESC', PR__MDL__WOOCOMMERCE_FILTER)])))); } } } } public function ewewecscqocemiqs($iwewcwusemqaiggk) { $aoskwucuugeuaeus = $this->caokeucsksukesyo()->kckogqkiycqeumoa(); $bgscekiuycggmyci = $aoskwucuugeuaeus->igawqaomowicuayw($iwewcwusemqaiggk, WoocommerceFilter::oqmosiywgecmeqig); $egcqoiemwoyoaewe = $aoskwucuugeuaeus->get($iwewcwusemqaiggk); if ($bgscekiuycggmyci && $egcqoiemwoyoaewe instanceof WP_Term && $egcqoiemwoyoaewe->parent) { $ugugimquukqwogge = $this->ewewecscqocemiqs($egcqoiemwoyoaewe->parent); } else { $ugugimquukqwogge = $aoskwucuugeuaeus->igawqaomowicuayw($iwewcwusemqaiggk, WoocommerceFilter::ugygausceickekgo); } return $ugugimquukqwogge; } public function ayseokmqycoqaigc($ymqmyyeuycgmigyo = null) : bool { if ($guwumyyyakswawas = $this->wqiaaecemqgacuww()) { $ugugimquukqwogge = $this->ewewecscqocemiqs($guwumyyyakswawas); if (is_array($ugugimquukqwogge) && in_array($ymqmyyeuycgmigyo, $ugugimquukqwogge, true)) { return false; } } if (!$ymqmyyeuycgmigyo || $ymqmyyeuycgmigyo === $this->aakmagwggmkoiiyu()) { return true; } return parent::ayseokmqycoqaigc($ymqmyyeuycgmigyo); } private function wqiaaecemqgacuww(?string $ymqmyyeuycgmigyo = null) : int { if (!$ymqmyyeuycgmigyo) { $ymqmyyeuycgmigyo = Constants::cmckeoksigiaqykc; } $sogksuscggsicmac = 0; $mumyimcwkaemyyue = $this->uwkmaywceaaaigwo()->owicscwgeuqcqaig(); if (Constants::cmckeoksigiaqykc === $ymqmyyeuycgmigyo && $mumyimcwkaemyyue->qmssqeyayicowkgy($ymqmyyeuycgmigyo)) { $sogksuscggsicmac = $mumyimcwkaemyyue->mwyqswsaeeewsosm(); } return $sogksuscggsicmac; } public function msgqcwqsemkmwqss($oyiyuuoguwwaksaa, &$gqgemcmoicmgaqie) { $icwicymcioeyeyek = $this->kokwyquiqyoaaioc()->ioegacqacywgucsc(); $seyqqsmuaiegkeeq = $this->mqmocoguqcyymgqu(); if ($gqgemcmoicmgaqie instanceof WP_Query) { $esygomwiykacwkye = $gqgemcmoicmgaqie->tax_query; if ($esygomwiykacwkye && isset($esygomwiykacwkye->queries)) { $esygomwiykacwkye = $esygomwiykacwkye->queries; $mqeowykqcggsieya = $this->caokeucsksukesyo()->yyoeeseewqmmyaee(); foreach ($seyqqsmuaiegkeeq as $kesssewsiegssiya) { if ($kesssewsiegssiya instanceof WP_Taxonomy) { $ymqmyyeuycgmigyo = $mqeowykqcggsieya->aakmagwggmkoiiyu($kesssewsiegssiya); if ($this->ayseokmqycoqaigc($ymqmyyeuycgmigyo)) { $eqgoocgaqwqcimie = $this->kokwyquiqyoaaioc()->oiqmuywqkkmuswuc(self::omumymwakeoiwouc . $ymqmyyeuycgmigyo, null, $icwicymcioeyeyek); if ($eqgoocgaqwqcimie) { if (!is_array($eqgoocgaqwqcimie)) { $eqgoocgaqwqcimie = [$eqgoocgaqwqcimie]; } $esygomwiykacwkye[] = [Constants::gueokgaoyascgeqe => Constants::ouywiegeiyuaaawo, Constants::ucoiewcoucauqwko => $eqgoocgaqwqcimie, Constants::ykemsyouoqyoaysg => Constants::iamiiekkgssgeaew, Constants::gmmygyiecgmggaam => $ymqmyyeuycgmigyo, 'include_children' => 1]; } } } } } $this->gmcqycoowqmycocs(); $gqgemcmoicmgaqie->set(Constants::kymceekcoyyeuocm, $esygomwiykacwkye); } return parent::msgqcwqsemkmwqss($oyiyuuoguwwaksaa, $gqgemcmoicmgaqie); } public function cccesyuceswckkqy($syquekoksmgewowm, $yygmoeguaqyumuui) : array { $kaigioacywcmqiam = $this->uwkmaywceaaaigwo()->aqasygcsqysmmyke()->eyysaeaoikgmcamm(); $wiciwwggyauswauk = []; if (!is_array($yygmoeguaqyumuui)) { $yygmoeguaqyumuui = [$yygmoeguaqyumuui]; } $gkyciwoiiisgywcs = $this->caokeucsksukesyo()->ywqgcuymeiswqyqc(); foreach ($yygmoeguaqyumuui as $uusmaiomayssaecw) { if ($eqgoocgaqwqcimie = $gkyciwoiiisgywcs->get($kaigioacywcmqiam, $uusmaiomayssaecw)) { $wiciwwggyauswauk[] = $eqgoocgaqwqcimie; } } if ($wiciwwggyauswauk) { $syquekoksmgewowm[] = [Constants::gmmygyiecgmggaam => 'product_visibility', Constants::eugyciakiowwcuwm => 'NOT IN', Constants::gueokgaoyascgeqe => 'term_taxonomy_id', Constants::ucoiewcoucauqwko => $wiciwwggyauswauk]; } return $syquekoksmgewowm; } public function qacygisasqiuosci() : bool { return (bool) Setting::symcgieuakksimmu()->giiuwsmyumqwwiyq(Setting::wsyysggyumwguois, false); } public function eicgqsyqqsccywwq($qwcmueausqgiwigy = false) : array { $yygmoeguaqyumuui = []; if (Constants::wiquocqckkqkmayo === $this->caokeucsksukesyo()->wikusamwomuogoau()->giiuwsmyumqwwiyq('hide_out_of_stock_items')) { $yygmoeguaqyumuui[] = 'outofstock'; } if ($this->qacygisasqiuosci()) { if (!$qwcmueausqgiwigy) { $yygmoeguaqyumuui[] = 'exclude-from-catalog'; } else { $yygmoeguaqyumuui[] = 'exclude-from-search'; } } return $yygmoeguaqyumuui; } public function gmcqycoowqmycocs() { $this->cecaguuoecmccuse('woocommerce_product_query_tax_query', function ($syquekoksmgewowm) { foreach ($syquekoksmgewowm as $uusmaiomayssaecw => $ieqocgiosekoeoqe) { if ('product_visibility' === $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ieqocgiosekoeoqe, Constants::gmmygyiecgmggaam)) { unset($syquekoksmgewowm[$uusmaiomayssaecw]); } } return $this->cccesyuceswckkqy($syquekoksmgewowm, $this->eicgqsyqqsccywwq(true)); }, 10, 2); $this->cecaguuoecmccuse('woocommerce_product_is_visible', '__return_true'); } public function uikgwcuascgeissw($kesssewsiegssiya) : ?string { $mqeowykqcggsieya = $this->caokeucsksukesyo()->yyoeeseewqmmyaee(); return $this->eeikyioeusswwmme(Constants::qescuiwgsyuikume, $mqeowykqcggsieya->aakmagwggmkoiiyu($kesssewsiegssiya), $mqeowykqcggsieya->qcgakseyaikigqco($kesssewsiegssiya)); } }
